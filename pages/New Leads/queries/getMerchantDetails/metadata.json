{
  "gitSyncId": "67854afe8f01ef5977743d0e_87727312-ad2f-4324-922f-53f8fa0f6ba2",
  "id": "New Leads_getMerchantDetails",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n    o.merchant_id AS \"Merchant ID\", \n    MIN(sorted_at) AS \"First Order Date\", \n    MAX(sorted_at) AS \"Last Order Date\",\n    COUNT(*) FILTER (WHERE sorted_at >= CURRENT_DATE - INTERVAL '1 day') AS \"Last Day Order\", \n    COUNT(consignment_id) AS \"Total Distinct Count\",\n    COUNT(DISTINCT DATE(sorted_at)) AS \"Active Days\",\n    COUNT(consignment_id) / NULLIF(COUNT(DISTINCT DATE(sorted_at)), 0) AS \"Average Order Count\"\nFROM remote_hermes.orders o\nleft join (\nselect merchant_id, min(created_at) as first_order_date, max(created_at) as last_order_date, count(*)\nfrom remote_hermes.orders \nwhere merchant_id = CAST({{ appsmith.store.selectedMerchantID }} AS Int)\ngroup by 1\n)a \non a.merchant_id = o.merchant_id\nWHERE o.merchant_id = CAST({{ appsmith.store.selectedMerchantID }} AS Int)\nAND transfer_status_id IN (8, 9, 10, 11, 12, 13, 22, 23, 24, 26, 28, 25, 14, 30, 31, 32, 33, 36, 37, 38, 39, 40, 41, 42)\nGROUP BY o.merchant_id;",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "hermes-write-db-prod",
      "isAutoGenerated": false,
      "name": "hermes-write-db-prod",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": true,
    "name": "getMerchantDetails",
    "pageId": "New Leads",
    "userSetOnLoad": false
  }
}