{
  "gitSyncId": "67854afe8f01ef5977743d0e_360df54f-f9e6-4309-8baa-3166062bb7c6",
  "id": "New Leads_duplicateMerchantCheck",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n    merchants.created_at AS \"Created At\",\n    merchants.id AS \"Merchant ID\",\n    merchants.name AS \"Business name\",\n    merchants.phone AS \"Business phone number\",\n    merchants.address AS \"Business address\",\n    merchant_users.name AS \"Owner name\",\n    merchant_users.phone AS \"Owner phone number\",\n    merchant_users.email AS \"Owner email address\",\n    (CASE WHEN merchants.product_category IS NULL THEN 'No Record' ELSE merchants.product_category END) AS \"Product category\",\n    x.first_order_date AS \"Date of first order\",\n    x.last_order_date AS \"Last Order Date\",\n    merchants.last_traversal_date AS \"Last traversal date\",\n    (CASE WHEN merchants.reject_reason IS NULL THEN 'No Record' ELSE merchants.reject_reason END) AS \"Reason for rejection\",\n    (CASE WHEN merchants.rejected_by IS NULL THEN 'No Record' ELSE merchants.rejected_by END) AS \"Rejected by\",\n\t\tx.order_count As \"Order Count\",\n    'button' AS \"Action\"\nFROM merchants \nINNER JOIN merchant_users ON merchants.owner_id = merchant_users.id \nLEFT JOIN (\n\tSELECT merchant_id, \n\tMIN(date(created_at)) AS first_order_date, \n\t\t\tMAX(date(created_at)) AS last_order_date, \n\t\t\tCOUNT(*) AS order_count\n\t\t\tFROM orders \n\t\t\tGROUP BY merchant_id\n\t\t ) x ON x.merchant_id = merchants.id\n\tWHERE merchants.phone = {{filterPhoneNumber.value }}\n\tORDER BY merchants.id DESC\n\tLIMIT 1;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "hermes-1-replica-3",
      "isAutoGenerated": false,
      "name": "hermes-1-replica-3",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": true,
    "name": "duplicateMerchantCheck",
    "pageId": "New Leads",
    "userSetOnLoad": false
  }
}